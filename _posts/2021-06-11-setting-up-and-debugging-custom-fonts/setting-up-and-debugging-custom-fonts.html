<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Setting up and debugging custom fonts</title>

  <meta property="description" itemprop="description" content="Plus a convenient way of rendering LaTeX expressions as images"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-06-11"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-06-11"/>
  <meta name="article:author" content="June Choe"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Setting up and debugging custom fonts"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Plus a convenient way of rendering LaTeX expressions as images"/>
  <meta property="og:image" content="https://yjunechoe.github.io/img/alegreya_word.png"/>
  <meta property="og:image:width" content="1169"/>
  <meta property="og:image:height" content="555"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:title" content="Setting up and debugging custom fonts"/>
  <meta property="twitter:description" content="Plus a convenient way of rendering LaTeX expressions as images"/>
  <meta property="twitter:image" content="https://yjunechoe.github.io/img/alegreya_word.png"/>
  <meta property="twitter:image:width" content="1169"/>
  <meta property="twitter:image:height" content="555"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","base_url","author","date","output","editor_options","draft"]}},"value":[{"type":"character","attributes":{},"value":["Setting up and debugging custom fonts"]},{"type":"character","attributes":{},"value":["Plus a convenient way of rendering LaTeX expressions as images\n"]},{"type":"character","attributes":{},"value":["data visualization","ggplot2","typography"]},{"type":"character","attributes":{},"value":["https://yjunechoe.github.io"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["June Choe"]},{"type":"character","attributes":{},"value":["University of Pennsylvania Linguistics"]},{"type":"character","attributes":{},"value":["https://live-sas-www-ling.pantheon.sas.upenn.edu/"]},{"type":"character","attributes":{},"value":["0000-0002-0701-921X"]}]}]},{"type":"character","attributes":{},"value":["06-11-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"logical","attributes":{},"value":[true]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["img/alegreya.png","img/alegreya_word.png","img/fa_otf.png","setting-up-and-debugging-custom-fonts_files/anchor-4.2.2/anchor.min.js","setting-up-and-debugging-custom-fonts_files/bowser-1.9.3/bowser.min.js","setting-up-and-debugging-custom-fonts_files/distill-2.2.21/template.v2.js","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plot-1..png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plot-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-10.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-11.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-12.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-2.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-3.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-4.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-5.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-6.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-7.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-8.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-9.png","setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-pre-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-fail-1..png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-fail-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-1..png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-2..png","setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-2.png","setting-up-and-debugging-custom-fonts_files/figure-html5/solid-fail-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/solid-success-1.png","setting-up-and-debugging-custom-fonts_files/figure-html5/unnamed-chunk-4-1..png","setting-up-and-debugging-custom-fonts_files/figure-html5/unnamed-chunk-4-1.png","setting-up-and-debugging-custom-fonts_files/header-attrs-2.8/header-attrs.js","setting-up-and-debugging-custom-fonts_files/jquery-1.11.3/jquery.min.js","setting-up-and-debugging-custom-fonts_files/popper-2.6.0/popper.min.js","setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy-bundle.umd.min.js","setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy-light-border.css","setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy.css","setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy.umd.min.js","setting-up-and-debugging-custom-fonts_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="setting-up-and-debugging-custom-fonts_files/header-attrs-2.8/header-attrs.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/popper-2.6.0/popper.min.js"></script>
  <link href="setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="setting-up-and-debugging-custom-fonts_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="setting-up-and-debugging-custom-fonts_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Setting up and debugging custom fonts","description":"Plus a convenient way of rendering LaTeX expressions as images","authors":[{"author":"June Choe","authorURL":"#","affiliation":"University of Pennsylvania Linguistics","affiliationURL":"https://live-sas-www-ling.pantheon.sas.upenn.edu/","orcidID":"0000-0002-0701-921X"}],"publishedDate":"2021-06-11T00:00:00.000+09:00","citationText":"Choe, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Setting up and debugging custom fonts</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">data visualization</div>
<div class="dt=tag">ggplot2</div>
<div class="dt=tag">typography</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Plus a convenient way of rendering LaTeX expressions as images</p></p>
</div>

<div class="d-byline">
  June Choe  (University of Pennsylvania Linguistics)<a href="https://live-sas-www-ling.pantheon.sas.upenn.edu/" class="uri">https://live-sas-www-ling.pantheon.sas.upenn.edu/</a>
  
<br/>06-11-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#setting-up-ragg">Setting up <code>{ragg}</code></a></li>
<li><a href="#installing-custom-fonts">Installing custom fonts</a></li>
<li><a href="#debugging-custom-fonts">Debugging custom fonts</a></li>
<li><a href="#hoisting-font-variants">Hoisting font variants</a></li>
</ul>
</nav>
</div>
<p>Getting custom fonts to work in R has historically been pretty difficult.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Folks who have ventured into this area are probably familiar with packages like <code>{showtext}</code> and <code>{extrafont}</code> which were the more established solutions to importing fonts in the past, though there’s always been a huge variation on people’s mileage with these packages because the issue runs much deeper.</p>
<p>At a high level, getting custom fonts to work involve the non-trivial task of unifying the <strong>graphics device</strong>, the <strong>operating system</strong>, and <strong>text rendering</strong> to seamlessly work with each other. Luckily for us in 2021, we have an amazing solution to this problem thanks to recent developments in the <code>{ragg}</code> and <code>{systemfonts}</code> packages by RStudio.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. For more details on the recent improvements to font support, you should check out these official blog posts:</p>
<ul>
<li><p><a href="https://www.tidyverse.org/blog/2020/05/updates-to-ragg-and-systemfonts/">Updates to ragg and systemfonts</a></p></li>
<li><p><a href="https://www.tidyverse.org/blog/2021/02/modern-text-features/">Modern Text Features in R</a></p></li>
<li><p><a href="https://www.tidyverse.org/blog/2021/02/svglite-2-0-0/">svglite 2.0.0</a></p></li>
</ul>
<p>This is great news because a lot of the work in getting custom fonts to work in R is being done for us under the hood!</p>
<h2 id="setting-up-ragg">Setting up <code>{ragg}</code></h2>
<p>The first thing you should do, if you haven’t already, is to install {<a href="https://ragg.r-lib.org/">ragg</a>} and {<a href="https://github.com/r-lib/systemfonts">systemfonts</a>}</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>'ragg'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>'systemfonts'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we want to make sure that whenever we output a plot<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, we do so using the <strong>AGG</strong> graphics device (that’s the “agg” part of “ragg”). There are at least four places where this is relevant:</p>
<ol type="1">
<li><p><strong>Rendering to the RStudio plot pane</strong> - for RStudio &gt;= 1.4, go to <em>Tools</em> &gt; <em>Global Options</em> &gt; <em>General</em> &gt; <em>Graphics</em> and set the <strong>Backend</strong> to AGG.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:sc"></span>
<img src="https://i.imgur.com/4XgiPWy.png" alt="Screenshot from the ragg package website - https://ragg.r-lib.org"  />
<p class="caption">
Figure 1: Screenshot from the ragg package website - <a href="https://ragg.r-lib.org" class="uri">https://ragg.r-lib.org</a>
</p>
</div>
</div></li>
<li><p><strong>Saving as external file</strong> - call any of the <code>ragg::agg_*()</code> functions to render plots using the AGG device.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Set output path</span>
 <span class='va'>pngfile</span> <span class='op'>&lt;-</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"img"</span>, <span class='st'>"my_plot.png"</span><span class='op'>)</span>
 <span class='co'># Initialize device</span>
 <span class='fu'>ragg</span><span class='fu'>::</span><span class='fu'><a href='https://ragg.r-lib.org/reference/agg_png.html'>agg_png</a></span><span class='op'>(</span>
   <span class='va'>pngfile</span>, width <span class='op'>=</span> <span class='fl'>10</span>, height <span class='op'>=</span> <span class='fl'>6</span>, units <span class='op'>=</span> <span class='st'>"in"</span>,
   res <span class='op'>=</span> <span class='fl'>300</span>, scaling <span class='op'>=</span> <span class='fl'>3</span>
 <span class='op'>)</span>
 <span class='co'># Plot</span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>$</span><span class='va'>mpg</span><span class='op'>)</span><span class='op'>)</span>
 <span class='co'># Close device</span>
 <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
 </code></pre>
</div>
</div>
<ul>
<li>The above way works for any plot, but if you use <code>{ggplot2}</code> and <code>ggplot2::ggsave()</code> a lot, you might wonder whether you can just pass in <code>ragg::agg_png()</code> into the <code>device</code> argument and specify the arguments in <code>ggsave()</code> instead. This turns out to actually not be so straightforward, but will likely be patched in the next update (v3.3.4?) <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. I personally just have the long-winded rendering method wrapped into <a href="https://github.com/yjunechoe/junebug/blob/master/R/plotsave_auto.R">a function in my personal package</a>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></li>
</ul></li>
<li><p><strong>RMarkdown outputs</strong> - Pass in a <code>{ragg}</code> device has <code>res</code> and <code>units</code> specified to the <code>dev</code> argument of <code>knitr::chunk_opts$set()</code> at the top of the script.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ragg_png</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>res</span> <span class='op'>=</span> <span class='fl'>150</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='fu'>ragg</span><span class='fu'>::</span><span class='fu'><a href='https://ragg.r-lib.org/reference/agg_png.html'>agg_png</a></span><span class='op'>(</span><span class='va'>...</span>, res <span class='op'>=</span> <span class='va'>res</span>, units <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
 <span class='op'>}</span>
 <span class='va'>opts_chunk</span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>dev <span class='op'>=</span> <span class='st'>"ragg_png"</span><span class='op'>)</span>
 </code></pre>
</div>
</div></li>
<li><p><strong>Shiny</strong> - Simply set <code>options(shiny.useragg = TRUE)</code> before rendering. Also check out the {<a href="https://rstudio.github.io/thematic/">thematic</a>} package for using custom fonts in shiny plot outputs.</p></li>
</ol>
<h2 id="installing-custom-fonts">Installing custom fonts</h2>
<p>Now that you have <code>{ragg}</code> and <code>{systemfonts}</code> installed, take it for a spin with a custom font! When you’re rendering plots using <code>{ragg}</code>, custom fonts should <em>just work</em> as long as you have them installed on your local machine.</p>
<p>If you haven’t really worked with custom fonts before, “installing a custom font” simply means finding the font file on the internet, downloading it, and drag-and-drop into a special folder on your local machine. It’s something like <code>Network/Library/Fonts</code> for Macs and <code>Microsoft/Windows/Fonts</code> for Windows. There can actually be a bit more to this (in Windows 10, for example, you have to drag and drop fonts onto the “Fonts” section of Settings), so make sure to google and check the process for installing fonts for your machine.</p>
<p>Font files come in many forms. In general, fonts files that match these two criteria tend to work the best:</p>
<ol type="1">
<li><p><strong>Fonts in <code>.otf</code> (OpenType Font) or <code>.ttf</code> (TrueType Font) formats</strong>. These are font formats that are installable on your machine. You want to avoid other formats like <code>.woff</code> or <code>.woff2</code>, for example, which are designed for use for the web. In theory both <code>.otf</code> and <code>.ttf</code> should work with <code>{ragg}</code>, though I’ve sometimes had trouble with <code>.otf</code>. In those cases, I simply converted the <code>.otf</code> font file to <code>.ttf</code> before installing it, using free online conversion tools that you can easily find on Google.</p></li>
<li><p><strong>Static fonts</strong>. A static font means that each <em>member</em> of the font family has their own set of <em>glyphs</em> (i.e., there is a font file for each <em>style</em>). This is in contrast to <em>variable fonts</em>, where you have a single font file which can take the form of multiple styles.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> To illustrate, look at the difference between the static (top) vs. variable (bottom) files for the <a href="https://fonts.google.com/specimen/Alegreya">Alegreya family</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:static"></span>
<img src="https://pbs.twimg.com/media/EzBpmgNXMAUBFfR?format=png&name=900x900" alt="Static font files for Alegreya"  />
<p class="caption">
Figure 2: Static font files for Alegreya
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:variable"></span>
<img src="https://pbs.twimg.com/media/EzBphU4WQAE6mFs?format=png&name=900x900" alt="Variable font files for Alegreya"  />
<p class="caption">
Figure 3: Variable font files for Alegreya
</p>
</div>
</div>
<p>We see that static fonts are differentiated from variable fonts by having a distinct file for each style, like <code>Alegreya-Black.ttf</code>. On the other hand, variable fonts usually say “variable” somewhere in the file name, and are slightly larger in size than any individual static member. Note that not all fonts have both static and variable files, and not all static and variable files are <code>.ttf</code> (there can be static <code>.otf</code> and variable <code>.ttf</code> files).<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p></li>
</ol>
<p>The above two images show the contents of the <code>.zip</code> file that you’d get if you went to <a href="https://fonts.google.com/">Google Fonts</a> (an awesome repository of free and open-source professional fonts) and clicked the <strong>Download family</strong> button on the <a href="https://fonts.google.com/specimen/Alegreya">page for Alegreya</a>. If you want to use Alegreya in R, then you simply drag-and-drop all the static font files in <code>/static</code> into your system’s font folder (or in Settings &gt; Fonts for Windows 10).</p>
<p>Once you install a custom font on your system, it should also be available elsewhere locally on your machine (this is a good sanity check). For example, I can use Alegreya in Microsoft Word after I download it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:word"></span>
<img src="img/alegreya_word.png" alt="Alegreya in Microsoft Word" width="584" />
<p class="caption">
Figure 4: Alegreya in Microsoft Word
</p>
</div>
</div>
<p>And by extension Alegreya should now be available for figures rendered with <code>{ragg}</code>. Let’s try using Alegreya in ggplot by passing it to the <code>family</code> argument of <code>geom_text()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"The Alegreya font"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>18</span>, family <span class='op'>=</span> <span class='st'>"Alegreya"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plot-1.png" width="624" /></p>
</div>
<p>It <em>just</em> works!</p>
<p>More specifically, it works because Alegreya is visible to <code>{systemfonts}</code>, which handles text rendering for <code>{ragg}</code>. If we filter list of fonts from <code>systemfonts::system_fonts()</code>, we indeed find the 12 styles of Alegreya from the static <code>.ttf</code> files that we installed!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-lib/systemfonts'>systemfonts</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/system_fonts.html'>system_fonts</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>family</span> <span class='op'>==</span> <span class='st'>"Alegreya"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span><span class='va'>family</span>, <span class='va'>style</span>, file <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>path</span>, <span class='st'>"[\\w-]+\\.ttf$"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  # A tibble: 12 x 3
     family   style            file                        
     &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;                       
   1 Alegreya Black Italic     Alegreya-BlackItalic.ttf    
   2 Alegreya Bold             Alegreya-Bold.ttf           
   3 Alegreya Bold Italic      Alegreya-BoldItalic.ttf     
   4 Alegreya ExtraBold        Alegreya-ExtraBold.ttf      
   5 Alegreya ExtraBold Italic Alegreya-ExtraBoldItalic.ttf
   6 Alegreya Italic           Alegreya-Italic.ttf         
   7 Alegreya Medium           Alegreya-Medium.ttf         
   8 Alegreya Medium Italic    Alegreya-MediumItalic.ttf   
   9 Alegreya Regular          Alegreya-Regular.ttf        
  10 Alegreya SemiBold         Alegreya-SemiBold.ttf       
  11 Alegreya SemiBold Italic  Alegreya-SemiBoldItalic.ttf 
  12 Alegreya Black            Alegreya-Black.ttf</code></pre>
</div>
<h2 id="debugging-custom-fonts">Debugging custom fonts</h2>
<p>So far we’ve seen that the workflow for setting up and installing fonts is very straightforward. But what do we do in times when things inevitable go wrong?</p>
<p>Consider the case of using <a href="https://fontawesome.com/">Font Awesome</a>, an icon font that renders <em>special character sequences</em> as <em>icon glyphs</em>.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> Font Awesome has a free version (<a href="https://raw.githubusercontent.com/FortAwesome/Font-Awesome/master/LICENSE.txt">CC-BY and SIL OFL license</a>), and say we want to use it for personal use for a <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a> submission.</p>
<p>The first thing we do is locate the font file. Font Awesome is open source, and the free version (Font Awesome 5 Free) is updated on Github. The most recent release as of this blog post is 5.15.3 - follow <a href="https://github.com/FortAwesome/Font-Awesome/releases/tag/5.15.3">this link</a> to download <code>fontawesome-free-5.15.3-desktop.zip</code>. If you unzip the file, you’ll find <code>.otf</code> font files corresponding to the three styles available in the free version: Regular, Solid, and Brands.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:fa-files"></span>
<img src="img/fa_otf.png" alt="Font Awesome 5 files" width="80%" />
<p class="caption">
Figure 5: Font Awesome 5 files
</p>
</div>
</div>
<p>Remember how I said R plays nicer with <code>.ttf</code> than <code>.otf</code> fonts? Lets go ahead and convert the <code>.otf</code> Font Awesome files using an online converter, like <a href="https://convertio.co/otf-ttf">https://convertio.co/otf-ttf</a>. Now, with the three font files in <code>.ttf</code> format, follow the instructions for installing fonts on your OS.</p>
<p>Once Font Awesome is installed on our local machine, it should be visible to <code>{systemfonts}</code>, like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/system_fonts.html'>system_fonts</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>family</span>, <span class='st'>"Font Awesome 5"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span><span class='va'>family</span>, <span class='va'>style</span>, file <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>path</span>, <span class='st'>"[\\w-]+\\.ttf$"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  # A tibble: 3 x 3
    family                style   file                                 
    &lt;chr&gt;                 &lt;chr&gt;   &lt;chr&gt;                                
  1 Font Awesome 5 Free   Solid   Font-Awesome-5-Free-Solid-900.ttf    
  2 Font Awesome 5 Brands Regular Font-Awesome-5-Brands-Regular-400.ttf
  3 Font Awesome 5 Free   Regular Font-Awesome-5-Free-Regular-400.ttf</code></pre>
</div>
<p>Now let’s try plotting some icons!</p>
<p>We see that we can render the Regular style (<a href="https://fontawesome.com/v5.15/icons/clock?style=regular">clock</a>) and the Brands style (<a href="https://fontawesome.com/v5.15/icons/twitter?style=brands">twitter</a>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Left plot</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"clock"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>50</span>, family <span class='op'>=</span> <span class='st'>"Font Awesome 5 Free"</span><span class='op'>)</span>

<span class='co'># Right plot</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"twitter"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>50</span>, family <span class='op'>=</span> <span class='st'>"Font Awesome 5 Brands"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-1.png" width="50%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/fa-success-2.png" width="50%" /></p>
</div>
<p>But what about rendering in the Solid style? Font Awesome tells me that the Solid style has a <a href="https://fontawesome.com/v5.15/icons/cat?style=solid">cat</a> icon, so let’s try it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"cat"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>50</span>, family <span class='op'>=</span> <span class='st'>"Font Awesome 5 Solid"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/fa-fail-1.png" width="624" /></p>
</div>
<p>Uh oh, that didn’t work. Well that’s because Solid is actually a <em>style</em>, not a family. If you go back to the output from <code>system_fonts()</code>, we see that Font Awesome actually consists of two font families: <strong>Font Awesome 5 Brands</strong> which has a “Regular” style, and <strong>Font Awesome 5 Free</strong> with a “Regular” style and a “Solid” style.</p>
<pre>
  fontawesome-free-5.15.3-desktop
  |--- Font Awesome 5 Free
       |  Regular
       |  Solid
  |--- Font Awesome 5 Brands
       |  Regular
</pre>
<p>In <code>geom_text()</code>, the font style is set by the <code>fontface</code> argument. When we don’t specify <code>fontface</code>, such as in our working example for the clock and twitter icons, it defaults to the regular style (Technically, it defaults to <code>fontface = "plain"</code>, which is the same thing).</p>
<p>So the solution to our problem is to put in <code>fontface = "solid"</code>, right…?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"cat"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>50</span>,
    family <span class='op'>=</span> <span class='st'>"Font Awesome 5 Free"</span>, fontface <span class='op'>=</span> <span class='st'>"solid"</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Error in FUN(X[[i]], ...): invalid fontface solid</code></pre>
</div>
<p>Well now it just errors! The issue here runs a bit deeper: if we track down the error,<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> it takes us to a function inside <code>grid::gpar()</code> that validates <code>fontface</code>. <a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> If we take a look at the code, we see that only a very few font styles are valid, and “solid” isn’t one of them.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>function</span> <span class='op'>(</span><span class='va'>ch</span><span class='op'>)</span> 
<span class='kw'><a href='https://rdrr.io/r/base/switch.html'>switch</a></span><span class='op'>(</span><span class='va'>ch</span>, plain <span class='op'>=</span> <span class='fl'>1L</span>, bold <span class='op'>=</span> <span class='fl'>2L</span>, italic <span class='op'>=</span> , oblique <span class='op'>=</span> <span class='fl'>3L</span>, bold.italic <span class='op'>=</span> <span class='fl'>4L</span>, 
  symbol <span class='op'>=</span> <span class='fl'>5L</span>, cyrillic <span class='op'>=</span> <span class='fl'>5L</span>, cyrillic.oblique <span class='op'>=</span> <span class='fl'>6L</span>, EUC <span class='op'>=</span> <span class='fl'>7L</span>, 
  <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"invalid fontface "</span>, <span class='va'>ch</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Okay, so then how can we ever access the Solid style of the Font Awesome 5 Free family? Luckily, there’s a solution: use <code>systemfonts::register_font</code> to register the Solid style as the “plain” style of its own font family!</p>
<p>You can do this by passing in the name of the new font family in the <code>name</code> argument and then setting the <code>plain</code> argument to the path of the font file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fa_solid_path</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/system_fonts.html'>system_fonts</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>family</span> <span class='op'>==</span> <span class='st'>"Font Awesome 5 Free"</span>, <span class='va'>style</span> <span class='op'>==</span> <span class='st'>"Solid"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>path</span><span class='op'>)</span>

<span class='fu'>systemfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/register_font.html'>register_font</a></span><span class='op'>(</span>
  name <span class='op'>=</span> <span class='st'>"Font Awesome 5 Free Solid"</span>,
  plain <span class='op'>=</span> <span class='va'>fa_solid_path</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>To check if we were successful in registering this new font variant, we can call <code>registry_fonts()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>systemfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/register_font.html'>registry_fonts</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span><span class='va'>family</span>, <span class='va'>style</span>, file <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>path</span>, <span class='st'>"[\\w-]+\\.ttf$"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  # A tibble: 4 x 3
    family                    style       file                             
    &lt;chr&gt;                     &lt;chr&gt;       &lt;chr&gt;                            
  1 Font Awesome 5 Free Solid Regular     Font-Awesome-5-Free-Solid-900.ttf
  2 Font Awesome 5 Free Solid Bold        Font-Awesome-5-Free-Solid-900.ttf
  3 Font Awesome 5 Free Solid Italic      Font-Awesome-5-Free-Solid-900.ttf
  4 Font Awesome 5 Free Solid Bold Italic Font-Awesome-5-Free-Solid-900.ttf</code></pre>
</div>
<p>Now our Solid font is available as the Regular (a.k.a. “plain”) style of its own font family, <strong>Font Awesome 5 Free Solid</strong>!<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>.</p>
<p>Now we’re back to our cat icon example. Again, because <a href="https://fontawesome.com/v5.15/icons/cat?style=solid">Font Awewsome says there’s a cat icon for Solid</a>, we’d expect a cat icon if we render the text “cat” with the Solid style. Let’s now set the <code>family</code> argument to our newly registered “Font Awesome 5 Free Solid” family and see what happens:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='st'>"cat"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>50</span>, family <span class='op'>=</span> <span class='st'>"Font Awesome 5 Free Solid"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/solid-success-1.png" width="624" /></p>
</div>
<p>Third time’s the charm !!!</p>
<h2 id="hoisting-font-variants">Hoisting font variants</h2>
<p>Hopefully the lesson is now clear: to make a custom font work in R, it must be <strong>visible to <code>systemfonts::system_fonts()</code> in a style that is accessible to <code>grid::gpar()</code></strong>. The nifty trick of registering an inaccessible style as the “plain” member of its own family can be extended and automated as a function. In my <a href="https://github.com/yjunechoe/junebug">experimental package</a>, I have a function called <a href="https://github.com/yjunechoe/junebug/blob/master/R/font_helpers.R"><code>font_hoist()</code></a> which “hoists”<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>/lifts <em>all</em> styles of a family as the “plain” style of their own families. This way, you never have to worry about things going wrong in the <code>fontface</code> argument.</p>
<p>Let’s apply this to our Alegreya family. As we saw earlier, it has 12 styles, but only 4 can be accessed by <code>grid::gpar()</code>.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> But once we hoist the styles, we can use all of them to render text!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install_github("yjunechoe/junebug")</span>
<span class='fu'>junebug</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/junebug/man/font_hoist.html'>font_hoist</a></span><span class='op'>(</span><span class='st'>"Alegreya"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Hoisted 12 variants:
  Alegreya Black Italic
  Alegreya Bold
  Alegreya Bold Italic
  Alegreya ExtraBold
  Alegreya ExtraBold Italic
  Alegreya Italic
  Alegreya Medium
  Alegreya Medium Italic
  Alegreya Regular
  Alegreya SemiBold
  Alegreya SemiBold Italic
  Alegreya Black</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Grab the newly registered font families</span>
<span class='va'>alegreya_styles</span> <span class='op'>&lt;-</span> <span class='fu'>systemfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/systemfonts/man/register_font.html'>registry_fonts</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>family</span>, <span class='st'>"Alegreya"</span><span class='op'>)</span>, <span class='va'>style</span> <span class='op'>==</span> <span class='st'>"Regular"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>family</span><span class='op'>)</span>

<span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>walk</a></span><span class='op'>(</span>
  <span class='va'>alegreya_styles</span>,
  <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-1.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-2.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-3.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-4.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-5.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-6.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-7.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-8.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-9.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-10.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-11.png" width="30%" /><img src="setting-up-and-debugging-custom-fonts_files/figure-html5/alegreya-plots-12.png" width="30%" /></p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>In fact, text rendering as a whole is an incredibly complicated task. Check out <a href="https://gankra.github.io/blah/text-hates-you/#how-do-you-write-that-you-cant-write">Text Rendering Hates You</a> for a fun and informative read.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Also check out the <code>{textshaping}</code> package for more!<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>I’m focusing on outputing to <em>bitmap</em> (e.g., <code>.png</code>, <code>.jpeg</code>, <code>.tiff</code>). For other formats like SVG (which I often default to for online material), you can use <code>svglite</code> - read more on the <a href="https://svglite.r-lib.org/">package website</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Check out the discussion on <a href="https://github.com/tidyverse/ggplot2/issues/4347">this issue</a> and <a href="https://github.com/tidyverse/ggplot2/issues/4347">this commit</a>. There’s also been some talk of making AGG the default renderer, though I don’t know if that’s been settled.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Please excuse the messy code.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>These are used to calculate DPI (dots per inch). Resolution is in pixels, so <code>res=150</code> and <code>units="inch"</code> is the same as <code>dpi=150</code>. <code>{ragg}</code> devices don’t have a <code>dpi</code> argument like the default device, so you have to specify both resolution and units.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>Variable fonts are hit-or-miss because while <code>{ragg}</code> and <code>{systemfonts}</code> <em>do</em> support some variable font features, “variable” can mean many different things, some of which are not supported (e.g., variable width)<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>In my experience, though, static fonts tend to be <code>.ttf</code> and variable fonts tend to be <code>.otf</code>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>The ability to render icon fonts is one of the most exciting part of improved text rendering in R, and you can learn more about them in a <a href="">lightning talk</a> that I recently gave on this topic.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p><code>options(error = recover)</code> is your friend! And remember to set <code>options(error = NULL)</code> back once you’re done!<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p>You might wonder: what’s the <code>{grid}</code> package doing here? Well, <code>{grid}</code> is kinda the “backend” for <code>{ggplot2}</code> that handles the actual “drawing to the canvas”, which is why it’s relevant here. For example, <code>geom_text()</code> returns a <strong>Gr</strong>aphical <strong>ob</strong>ject (“Grob”), specifically <code>grid::textGrob()</code>, that inherits arguments like <code>family</code> and <code>fontface</code> (which are in turn passed into <code>grid::gpar()</code>).<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12" role="doc-endnote"><p>It’s also registered as the Bold, Italic, and Bold Italic styles as well, which is what happens by default if you only supply the <code>plain</code> argument to <code>register_font()</code>. You can just ignore this.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13" role="doc-endnote"><p>Borrowing terminology from <code>tidyr::hoist()</code>, the under-appreciated beast of list-column workflows<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14" role="doc-endnote"><p>Regular as “plain”, Bold as “bold”, Italic as “italic”, and Bold Italic as “bold.italic”.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
