---
title: "Plot Makeover #2"
description: |
  A short description of the post.
categories:
  - plot makeover
  - data visualization
  - ggplot2
base_url: https://yjunechoe.github.io
author:
  - name: June Choe
    affiliation: University of Pennsylvania Linguistics
    affiliation_url: https://live-sas-www-ling.pantheon.sas.upenn.edu/
    orcid_id: 0000-0002-0701-921X
preview: preview.png
date: 11-04-2020
output:
  distill::distill_article:
    toc: true
    self_contained: false
draft: true
---


```{r}
library(tidyverse)

df <- tribble(
  ~Condition, ~Referent, ~Accuracy,
  "Primacy",  "Single",  0.63,
  "Primacy",  "Primacy", 0.59,
  "Recency",  "Single",  0.63,
  "Recency",  "Recency", 0.5,
  "Both",     "Single",  0.63,
  "Both",     "Primacy", 0.5,
  "Both",     "Recency", 0.31
) %>% 
  mutate(
    error_low = runif(7, .04, .06),
    error_high = runif(7, .04, .06),
    Condition_name = factor(Condition, levels = c("Primacy", "Recency", "Both")),
    Condition = as.numeric(Condition_name),
    Referent = factor(Referent, levels = c("Single", "Primacy", "Recency")),
    left = Referent == "Single",
    color = case_when(
      Referent == "Single" ~ "#29476B",
      Referent == "Primacy" ~ "#AD403D",
      Referent == "Recency" ~ "#9BBB58"
    )
  )


ggplot(mapping = aes(x = Condition, y = Accuracy, fill = color)) +
  geom_col(
    data = filter(df, left),
    width = .3,
    color = "white",
    position = position_nudge(x = -.3)
  ) +
  geom_errorbar(
    aes(ymin = Accuracy - error_low, ymax = Accuracy + error_high),
    data = filter(df, left),
    width = .1,
    position = position_nudge(x = -.3)
  ) +
  geom_col(
    data = filter(df, !left),
    color = "white",
    width = .3,
  ) +
  geom_errorbar(
    aes(y = y, ymin = y - error_low, ymax = y + error_high),
    data = filter(df, !left) %>% 
      group_by(Condition) %>% 
      mutate(y = accumulate(Accuracy, sum)),
    width = .1
  ) +
  scale_fill_identity(
    labels = levels(df$Referent),
    guide = guide_legend(title = "Referent")
  ) +
  scale_x_continuous(
    breaks = 1:3 - .15,
    labels = levels(df$Condition_name),
    expand = expansion(.1)
  ) +
  scale_y_continuous(
    limits = 0:1,
    expand = expansion(0)
  ) +
  theme_classic(
    base_family = "Roboto",
    base_size = 16
  )
```

